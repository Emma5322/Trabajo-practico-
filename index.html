<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viajes Auricular</title>
    <link rel="icon" href="Images/Viajes auricular.png">
    <link rel="stylesheet" href="Estilo.css">
</head>

<body>
    <div class="conteiner">
        <script type="text/javascript" src="header.js"></script>
       
        <div class="izq"></div>

        <div class="der"></div>

        <div class="contenido">

            <div class="formulario" id="formulariobusqueda">
                <form name="buscarvuelo" onsubmit="return validarBusquedaVuelo()">
                    <div class="barrasuperior">
                        <h1>Buscá tu vuelo</h1>
                    </div>
                    <div>
                        <label for="">Origen</label>
                        <input   list="browsers" id="origen" placeholder="Ingresá una ciudad">
                            <datalist id="browsers" role="listbox">
                                <option value="Buenos Aires - Argentina">Buenos Aires - Argentina</option>
                                <option value="El Calafate - Argentina">El Calafate - Argentina</option>
                                <option value="Catamarca - Argentina">Catamarca - Argentina</option>
                                <option value="Comodoro Rivadavia - Argentina">Comodoro Rivadavia - Argentina</option>
                                <option value="Córdoba - Argentina">Córdoba - Argentina</option>
                                <option value="Corrientes - Argentina">Corrientes - Argentina</option>
                                <option value="Formosa - Argentina">Formosa - Argentina</option>
                                <option value="Iguazú - Argentina">Iguazú - Argentina</option>
                                <option value="Jujuy - Argentina">Jujuy - Argentina</option>
                                <option value="La Rioja - Argentina">La Rioja - Argentina</option>
                                <option value="Catamarca - Argentina">Catamarca - Argentina</option>
                                <option value="Mar del Plata - Argentina">Mar del Plata - Argentina</option>
                                <option value="Mendoza - Argentina">Mendoza - Argentina</option>
                                <option value="Neuquén - Argentina">Neuquén - Argentina</option>
                                <option value="Paraná - Argentina">Paraná - Argentina</option>
                                <option value="Posadas - Argentina">Posadas - Argentina</option>
                                <option value="Resistencia - Argentina">Resistencia - Argentina</option>
                                <option value="Río Gallegos - Argentina">Río Gallegos - Argentina</option>
                                <option value="Rosario - Argentina">Rosario - Argentina</option>
                                <option value="Salta - Argentina">Salta - Argentina</option>
                                <option value="San Carlos de Bariloche - Argentina">San Carlos de Bariloche - Argentina
                                </option>
                                <option value="San Juan - Argentina">San Juan - Argentina</option>
                                <option value="San Luis - Argentina">San Luis - Argentina</option>
                                <option value="Tucumán - Argentina">Tucumán - Argentina</option>
                                <option value="Santa Fe - Argentina">Santa Fe - Argentina</option>
                                <option value="Santa Rosa - Argentina">Santa Rosa - Argentina</option>
                                <option value="Santiago del Estero - Argentina">Santiago del Estero - Argentina</option>
                                <option value="Trelew - Argentina">Trelew - Argentina</option>
                                <option value="Ushuaia - Argentina">Ushuaia - Argentina</option>
                                <option value="Viedma - Argentina">Viedma - Argentina</option>
                                <option value="Chapelco - Argentina">Chapelco - Argentina</option>
                               </datalist>
                                                                      

                        <label for="">Destino</label>
                        <input  id="destino" list="browsers"  placeholder="Ingresá una ciudad">
                                                   

                        <label for="" id="labelsalida">Salida</label>
                        <input type="date" id="inputsalida">
                    </div>
                    <div class="segundo" id="segundo">
                        <label for="">Origen</label>
                        <input id="origen2" list="browsers" type="text" placeholder="Ingresá una ciudad">
                        <label for="">Destino</label>
                        <input id="destino2" list="browsers" type="text" placeholder="Ingresá una ciudad">
                        <label for="">Salida</label>
                        <input type="date" id="inputsalida2">
                    </div>
                    <div style="flex-direction: row;">
                        <input type="radio" id="idayvuelta" name="seleccion" onclick="idaVuelta()" checked>
                        <label for="">Ida y vuelta</label>
                        <input type="radio" id="soloida" name="seleccion" onclick="soloIda()">
                        <label for="">Solo ida</label>
                        <input type="radio" id="multipledestino" name="seleccion" onclick="multipleDestinos()">
                        <label for="">Multiple destinos</label>
                        <select class="select" id="clase">
                            <option value=1>Todas las clases</option>
                            <option value="2">Clase económica</option>
                            <option value="3">Clase ejecutiva</option>
                        </select>
                    </div>
                    <div id="dividayvuelta">
                        <label for="" id="ida">Ida</label>
                        <input type="date" id="inputida">
                        <label for="" id="labelvuelta">Vuelta</label>
                        <input type="date" id="inputvuelta">
                    </div>

                </form>

            </div>
            <div class="formulario2" id="formulariovuelo">
                <form onsubmit="return validarBusquedaVuelo()">
                    <div class="barrasuperior2">
                        <h1>Pasajeros</h1>
                        <div>
                            <label for="">Mayores(+18)</label>
                            <select id="adultos">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                        <div>
                            <label for="">Menores (2-17)</label>
                            <select id="niños">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <div>
                            <label for="">Bebés (0-2)</label>
                            <select id="bebes">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                            </select>

                        </div>
                        <div>
                            <input type="submit" value="Buscar">
                        </div>
                    </div>
                </form>
            </div>



            <div class="vuelos" id="itinerariovuelo" style="display: none;">
                <div class="barrasuperior">
                    <h1>Ida</h1>
                </div>
                <form id="formularioModificar">
                    <label for="descripcionModificar">Descripción:</label>
                    <input type="text" id="descripcionModificar" name="descripcionModificar" required><br>
        
                    <label for="cantidadModificar">Cantidad:</label>
                    <input type="number" id="cantidadModificar" name="cantidadModificar" required><br>
        
                    <label for="precioModificar">Precio:</label>
                    <input type="number" step="0.01" id="precioModificar" name="precioModificar" required><br>
        
                    <button type="submit">Guardar Cambios</button>
                    <a href="modificaciones.html">Cancelar</a>
                </form>
            </div>




        </div>
    



        







    <div class="ofertas">
        <div>
            <h1>¡Aprovechá nuestras ofertas!</h1>
        </div>
        <div class="tablaviaje">
            <div>
                <img src="Images/Rio de janeiro.jpg" alt="">
                <label for="">Rio de janeiro</label>
                <p>$54900</p>
            </div>
            <div>
                <img src="Images/Londres.jpg" alt="">
                <label for="">Londres</label>
                <p>$109899</p>
            </div>
            <div>
                <img src="Images/Francia.jpg" alt="">
                <label for="">Paris</label>
                <p>$119899</p>
            </div>
            <div>
                <img src="Images/New york.jpg" alt="">
                <label for="">New york</label>
                <p>$95989</p>
            </div>
        </div>
    </div>

    <footer>
        <script type="text/javascript" src="footer.js"></script>
    </footer>
    <script type="text/javascript" src="validacionbuscavuelo.js"></script>


    <script>
        //const URL = "http://127.0.0.1:5000/"
        const URL = "https://emmanuel5322.pythonanywhere.com/";
        

        // Capturamos el evento de envío del formulario para mostrar los datos del producto
        document.getElementById('formulariovuelo').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitamos que se recargue la página

            // Obtenemos el código del vuelo
            var origen = document.getElementById('origen').value;
            var destino = document.getElementById('destino').value;
            var idayvuelta = document.getElementById('idayvuelta').value;
            var soloida = document.getElementById('soloida').value;
            var multipledestino = document.getElementById('multipledestino').value;
            var codigo = document.getElementById('clase').value;
            var inputida = document.getElementById('inputida').value;
            var inputvuelta = document.getElementById('inputvuelta').value;
            var origen2 = document.getElementById('origen2').value;
            var destino2 = document.getElementById('destino2').value;
            var inputsalida = document.getElementById('inputsalida').value;
            var inputsalida2 = document.getElementById('inputsalida2').value;

            console.log(codigo)

            

            // Realizamos la solicitud GET al servidor para obtener los datos del producto
            fetch(URL + 'vuelos/' + codigo)
                .then(function (response) {
                    if (response.ok) {
                        return response.json(); // Parseamos la respuesta JSON
                    } else {
                        // Si hubo un error, lanzar explícitamente una excepción
                        // para ser "catcheada" más adelante
                        throw new Error('Error al obtener la busqueda vuelo');
                    }
                })
                .then(function (data) {
                    // Mostramos los datos del producto en el formulario de modificación
                    document.getElementById('descripcionModificar').value = data.destino;
                    document.getElementById('cantidadModificar').value = data.origen;
                    document.getElementById('precioModificar').value = data.precio;

                    // Mostramos el formulario de modificación y ocultamos el formulario de consulta
                    document.getElementById('formulariovuelo').style.display = 'none';
                    document.getElementById('formulariobusqueda').style.display = 'none';
                    document.getElementById('itinerariovuelo').style.display = 'block';
                })
                .catch(function (error) {
                    // Código para manejar errores
                    alert('Error al obtener los datos del vuelo 2.');
                });
        });

        // Capturamos el evento de envío del formulario de modificación
        document.getElementById('formularioModificar').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitamos que se recargue la página

            // Obtenemos los valores del formulario de modificación
            var codigo = document.getElementById('codigo').value;
            var descripcion = document.getElementById('descripcionModificar').value;
            var cantidad = document.getElementById('cantidadModificar').value;
            var precio = document.getElementById('precioModificar').value;

            // Creamos un objeto con los datos del producto actualizados
            var producto = {
                codigo: codigo,
                descripcion: descripcion,
                cantidad: cantidad,
                precio: precio
            };

            // Realizamos la solicitud PUT al servidor para guardar los cambios
            fetch(URL + 'productos/' + codigo, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(producto)
            })
                .then(function (response) {
                    if (response.ok) {
                        return response.json(); // Parseamos la respuesta JSON
                    } else {
                        // Si hubo un error, lanzar explícitamente una excepción
                        // para ser "catcheada" más adelante
                        throw new Error('Error al guardar los cambios del producto.');
                    }
                })
                .then(function (data) {
                    alert('Cambios guardados correctamente.');
                    location.reload(); // Recargamos la página para volver al formulario de consulta
                })
                .catch(function (error) {
                    // Código para manejar errores
                    alert('Error al guardar los cambios del producto.');
                })
        });
    </script>
</div>

</body>

</html>