<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viajes Auricular</title>
    <link rel="icon" href="Images/Viajes auricular.png">
    <link rel="stylesheet" href="Estilo.css">
</head>

<body>
    <div class="conteiner">
        <script type="text/javascript" src="header.js"></script>
       
        <div class="izq"></div>

        <div class="der"></div>

        <div class="contenido">

            <div class="formulario" id="formulariobusqueda" style="display: block;">
                <form name="buscarvuelo" onsubmit="return validarBusquedaVuelo()">
                    <div class="barrasuperior">
                        <h1>Buscá tu vuelo</h1>
                    </div>
                    <div>
                        <label for="">Origen</label>
                        <input   list="browsers" id="origen" placeholder="Ingresá una ciudad">
                            <datalist id="browsers" role="listbox">
                                <option value="EZE">Buenos Aires - Argentina</option>
                                <option value="FTE">El Calafate - Argentina</option>
                                <option value="CTC">Catamarca - Argentina</option>
                                <option value="CRD">Comodoro Rivadavia - Argentina</option>
                                <option value="COR">Córdoba - Argentina</option>
                                <option value=CNQ>Corrientes - Argentina</option>
                                <option value="FMA">Formosa - Argentina</option>
                                <option value="IGR">Iguazú - Argentina</option>
                                <option value="JUJ">Jujuy - Argentina</option>
                                <option value="IRJ">La Rioja - Argentina</option>
                                <option value="MDQ">Mar del Plata - Argentina</option>
                                <option value=MDZ>Mendoza - Argentina</option>
                                <option value="NQN">Neuquén - Argentina</option>
                                <option value="PRA">Paraná - Argentina</option>
                                <option value="PSS">Posadas - Argentina</option>
                                <option value="RSS">Resistencia - Argentina</option>
                                <option value="RGL">Río Gallegos - Argentina</option>
                                <option value="ROS">Rosario - Argentina</option>
                                <option value="SLA">Salta - Argentina</option>
                                <option value="BRC">San Carlos de Bariloche - Argentina
                                </option>
                                <option value="UAQ">San Juan - Argentina</option>
                                <option value="LUQ">San Luis - Argentina</option>
                                <option value="TUC">Tucumán - Argentina</option>
                                <option value="SAF">Santa Fe - Argentina</option>
                                <option value="RSA">Santa Rosa - Argentina</option>
                                <option value="SGO">Santiago del Estero - Argentina</option>
                                <option value="TRE">Trelew - Argentina</option>
                                <option value="USH">Ushuaia - Argentina</option>
                                <option value="VDM">Viedma - Argentina</option>
                                <option value="CPC">Chapelco - Argentina</option>
                               </datalist>
                                                                      

                        <label for="">Destino</label>
                        <input  id="destino" list="browsers"  placeholder="Ingresá una ciudad">
                                                   

                        <label for="" id="labelsalida">Salida</label>
                        <input type="date" id="inputsalida">
                    </div>
                    <div class="segundo" id="segundo">
                        <label for="">Origen</label>
                        <input id="origen2" list="browsers" type="text" placeholder="Ingresá una ciudad">
                        <label for="">Destino</label>
                        <input id="destino2" list="browsers" type="text" placeholder="Ingresá una ciudad">
                        <label for="">Salida</label>
                        <input type="date" id="inputsalida2">
                    </div>
                    <div style="flex-direction: row;">
                        <input type="radio" id="idayvuelta" name="seleccion" onclick="idaVuelta()" checked>
                        <label for="">Ida y vuelta</label>
                        <input type="radio" id="soloida" name="seleccion" onclick="soloIda()">
                        <label for="">Solo ida</label>
                        <input type="radio" id="multipledestino" name="seleccion" onclick="multipleDestinos()">
                        <label for="">Multiple destinos</label>
                        <select class="select" id="clase">
                            <option value=1>Todas las clases</option>
                            <option value="2">Clase económica</option>
                            <option value="3">Clase ejecutiva</option>
                        </select>
                    </div>
                    <div id="dividayvuelta">
                        <label for="" id="ida">Ida</label>
                        <input type="date" id="inputida">
                        <label for="" id="labelvuelta">Vuelta</label>
                        <input type="date" id="inputvuelta">
                    </div>

                </form>

            </div>
            <div class="formulario2" id="formulariovuelo" style="display: block;">
                <form onsubmit="return validarBusquedaVuelo()">
                    <div class="barrasuperior2">
                        <h1>Pasajeros</h1>
                        <div>
                            <label for="">Mayores(+18)</label>
                            <select id="adultos">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                            </select>
                        </div>
                        <div>
                            <label for="">Menores (2-17)</label>
                            <select id="niños">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select>
                        </div>
                        <div>
                            <label for="">Bebés (0-2)</label>
                            <select id="bebes">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                            </select>

                        </div>
                        <div>
                            <input type="submit" value="Buscar">
                        </div>
                    </div>
                </form>
            </div>



            <div class="vuelos" id="itinerariovuelo" style="display: none;">
                <div class="barrasuperiorvuelo">
                    <h1>Ida</h1>
                </div>
                <div id="vuelosida">
                </div> 
                
            </div>  
 
        </div>  
            
                    
                    
                    
                    
                    
            





        
    



        







    <div class="ofertas">
        <div>
            <h1>¡Aprovechá nuestras ofertas!</h1>
        </div>
        <div class="tablaviaje">
            <div>
                <img src="Images/Rio de janeiro.jpg" alt="">
                <label for="">Rio de janeiro</label>
                <p>$54900</p>
            </div>
            <div>
                <img src="Images/Londres.jpg" alt="">
                <label for="">Londres</label>
                <p>$109899</p>
            </div>
            <div>
                <img src="Images/Francia.jpg" alt="">
                <label for="">Paris</label>
                <p>$119899</p>
            </div>
            <div>
                <img src="Images/New york.jpg" alt="">
                <label for="">New york</label>
                <p>$95989</p>
            </div>
        </div>
    </div>

    <footer>
        <script type="text/javascript" src="footer.js"></script>
    </footer>
    <script type="text/javascript" src="validacionbuscavuelo.js"></script>


    <script>
        //const URL = "http://127.0.0.1:5000/"
        const URL = "https://emmanuel5322.pythonanywhere.com/";
        

        // Capturamos el evento de envío del formulario para mostrar los datos del producto
        document.getElementById('formulariovuelo').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitamos que se recargue la página

            // Obtenemos el código del vuelo
            var codigoorigen = document.getElementById('origen').value;
            var codigodestino = document.getElementById('destino').value;
            var idayvuelta = document.getElementById('idayvuelta').value;
            var soloida = document.getElementById('soloida').value;
            var multipledestino = document.getElementById('multipledestino').value;
            var codigo = document.getElementById('clase').value;
            var inputida = document.getElementById('inputida').value;
            var inputvuelta = document.getElementById('inputvuelta').value;
            var origen2 = document.getElementById('origen2').value;
            var destino2 = document.getElementById('destino2').value;
            var inputsalida = document.getElementById('inputsalida').value;
            var inputsalida2 = document.getElementById('inputsalida2').value;
            
            console.log(codigoorigen)
            console.log(codigodestino)
            console.log(idayvuelta)
            console.log(soloida)
            console.log(multipledestino)
            console.log(inputida)
            console.log(inputvuelta)
            console.log(origen2)
            console.log(destino2)
            console.log(inputsalida)
            console.log(inputsalida2)
            console.log(codigo)

            

            

            // Realizamos la solicitud GET al servidor para obtener los datos del producto
            fetch(URL + 'vuelos/' + codigoorigen + '/' + codigodestino)
                .then(function (response) {
                    if (response.ok) {
                        return response.json(); // Parseamos la respuesta JSON
                    } else {
                        // Si hubo un error, lanzar explícitamente una excepción
                        // para ser "catcheada" más adelante
                        throw new Error('Error al obtener la busqueda vuelo');
                    }
                })
                .then(function (data) {
                    var vuelosida = document.getElementById('vuelosida');
                    console.log(vuelosida)

                    data.forEach(function (vuelo) {

                        
                    //var fila = document.createElement('tr');
                    //fila.innerHTML = '<td>' + producto.codigo + '</td>' +
                        //'<td>' + producto.descripcion + '</td>' +
                        //'<td align="right">' + producto.cantidad + '</td>' +
                        //'<td align="right">&nbsp; &nbsp;&nbsp; &nbsp;' + producto.precio + '</td>';
                    //vuelosida.appendChild(fila);
                //});
                var fila = document.createElement('div');
                console.log(fila)
                fila.innerHTML = '<div class="pruebaflex">'+
                    '<div class="pruebaflex2">'+
                        '<label>'  + vuelo.codigo + '</label>'+
                        '<label id="numerovuelo">' + vuelo.numerovuelo + '</label>'+
                    '</div>'+
                    '<div class="pruebaflex2">'+
                        '<h1 id="origenvuelo">' + vuelo.codigoorigen + '</h1>'+
                        '<label id="horariosalida">' + vuelo.horariosalida + '</label>'+
                    '</div>'+
                    '<div class="pruebaflex2">'+
                        '<img src="Images/avion.png" height="40px">'+
                        '<label id="asientoslibres">' + vuelo.asientoslibres + '</label>'+
                    '</div>'+
                    '<div class="pruebaflex2">'+
                        '<h1 id="destinovuelo">' + vuelo.codigodestino + '</h1>'+
                        '<label id="horariollegada">' + vuelo.horariollegada + '</label>'+
                        '</div>'+  
                    '<div class="pruebaflex2">'+
                        '<label>Precio</label>' +
                        '<label id="precio">' + vuelo.precio + '</label>' +
                    '</div>';
                vuelosida.appendChild(fila);
                });


                    // Mostramos el formulario de modificación y ocultamos el formulario de consulta
                    document.getElementById('formulariovuelo').style.display = 'none';
                    document.getElementById('formulariobusqueda').style.display = 'none';
                    document.getElementById('itinerariovuelo').style.display = 'block';
                })
                .catch(function (error) {
                    // Código para manejar errores
                    alert('Error al obtener los datos del vuelo 2.');
                });
        });

        // Capturamos el evento de envío del formulario de modificación
        document.getElementById('formularioModificar').addEventListener('submit', function (event) {
            event.preventDefault(); // Evitamos que se recargue la página

            // Obtenemos los valores del formulario de modificación
            var codigo = document.getElementById('codigo').value;
            var descripcion = document.getElementById('descripcionModificar').value;
            var cantidad = document.getElementById('cantidadModificar').value;
            var precio = document.getElementById('precioModificar').value;

            // Creamos un objeto con los datos del producto actualizados
            var producto = {
                codigo: codigo,
                descripcion: descripcion,
                cantidad: cantidad,
                precio: precio
            };

            // Realizamos la solicitud PUT al servidor para guardar los cambios
            fetch(URL + 'productos/' + codigo, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(producto)
            })
                .then(function (response) {
                    if (response.ok) {
                        return response.json(); // Parseamos la respuesta JSON
                    } else {
                        // Si hubo un error, lanzar explícitamente una excepción
                        // para ser "catcheada" más adelante
                        throw new Error('Error al guardar los cambios del producto.');
                    }
                })
                .then(function (data) {
                    alert('Cambios guardados correctamente.');
                    location.reload(); // Recargamos la página para volver al formulario de consulta
                })
                .catch(function (error) {
                    // Código para manejar errores
                    alert('Error al guardar los cambios del producto.');
                })
        });
    </script>
</div>

</body>

</html>